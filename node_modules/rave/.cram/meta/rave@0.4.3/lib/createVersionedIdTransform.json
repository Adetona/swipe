{"absId":"rave@0.4.3/lib/createVersionedIdTransform","pluginId":"curl/loader/cjsm11","resourceId":"rave@0.4.3/lib/createVersionedIdTransform","loader":true,"source":"define('rave@0.4.3/lib/createVersionedIdTransform',['require','exports','module'],function(require,exports,module,define){/** @license MIT License (c) copyright 2014 original authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\nvar createUid = require('./uid').create;\nvar metadata = require('./metadata');\nvar path = require('./path');\n\nmodule.exports = createVersionedIdTransform;\n\nfunction createVersionedIdTransform (context) {\n\tvar packages;\n\n\tpackages = context.packages;\n\n\treturn function (normalized, refUid, refUrl) {\n\t\tvar refPkg, depPkg;\n\n\t\trefPkg = metadata.findPackage(packages, refUid);\n\t\tdepPkg = metadata.findDepPackage(packages, refPkg, normalized);\n\n\t\tif (!depPkg) {\n\t\t\tdepPkg = metadata.findPackage(packages, normalized);\n\t\t}\n\n\t\tif (!depPkg) {\n\t\t\tthrow new Error('Package not found for ' + normalized);\n\t\t}\n\n\t\t// translate package main (e.g. \"rest\" --> \"rest/rest\")\n\t\tif (normalized === depPkg.name && depPkg.main) {\n\t\t\tnormalized = depPkg.main.charAt(0) === '.'\n\t\t\t\t? path.reduceLeadingDots(depPkg.main, path.ensureEndSlash(depPkg.name))\n\t\t\t\t: path.joinPaths(depPkg.name, depPkg.main);\n\t\t}\n\n\t\tif (normalized.indexOf('#') < 0) {\n\t\t\t// it's not already an uid\n\t\t\tnormalized = createUid(depPkg, normalized);\n\t\t}\n\n\t\treturn normalized;\n\t};\n}\n\n});\n\n","modules":[{"pos":0,"count":121,"id":"rave@0.4.3/lib/createVersionedIdTransform","depList":["require","exports","module"],"factory":true,"argList":["require","exports","module","define"],"requires":[{"id":"rave@0.4.3/lib/uid","pos":257,"count":16},{"id":"rave@0.4.3/lib/metadata","pos":297,"count":21},{"id":"rave@0.4.3/lib/path","pos":331,"count":17}]}],"compileTime":"2014-11-17T20:58:47.369Z"}