{"absId":"rave@0.4.3/lib/crawl/bower","pluginId":"curl/loader/cjsm11","resourceId":"rave@0.4.3/lib/crawl/bower","loader":true,"source":"define('rave@0.4.3/lib/crawl/bower',['require','exports','module'],function(require,exports,module,define){/** @license MIT License (c) copyright 2014 original authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar join = require('../path').joinPaths;\nvar common = require('./common');\n\n// main exports\n\nexports.crawl = bowerCrawl;\n\n// exports for testing\n\nexports.bowerLoad = bowerLoad;\nexports.bowerContext = bowerContext;\nexports.bowerSetState = bowerSetState;\nexports.bowerChildCrawler = bowerChildCrawler;\nexports.bowerDependencies = bowerDependencies;\n\nvar crawl = common.crawl;\nvar load = common.load;\n\nfunction bowerCrawl (convert, rootUrl) {\n\tvar crawler = {\n\t\tglobalDepFolder: join(rootUrl, 'bower_components'),\n\t\tload: bowerLoad,\n\t\tgetChildrenNames: bowerDependencies,\n\t\tconvert: convert\n\t};\n\tvar context = bowerContext(crawler, rootUrl, '');\n\n\tcontext.childCrawler = bowerChildCrawler;\n\tcontext.all = [];\n\n\treturn crawl(context)\n\t\t.then(function (root) {\n\t\t\treturn {\n\t\t\t\troot: root,\n\t\t\t\tall: context.all\n\t\t\t}\n\t\t});\n}\n\nfunction bowerLoad (context, fileUrl) {\n\treturn load(context, fileUrl)\n\t\t['catch'](switchToPackageJson)\n\t\t['catch'](provideBlankData);\n\n\tfunction switchToPackageJson () {\n\t\tvar fileType = context.fileType = 'package.json';\n\t\tcontext.fileUrl = join(context.rootUrl, fileType);\n\t\treturn load(context, context.fileUrl);\n\t}\n\n\tfunction provideBlankData () {\n\t\tcontext.fileType = '';\n\t\treturn null;\n\t}\n}\n\nfunction bowerContext (base, rootUrl, name) {\n\tvar ctx = Object.create(base);\n\tctx.name = name;\n\tctx.overrides = Object.create(base.overrides || null);\n\tctx.missing = Object.create(base.missing || null);\n\treturn bowerSetState(ctx, rootUrl, name);\n}\n\nfunction bowerSetState (ctx, rootUrl, name) {\n\tvar fileType = 'bower.json';\n\tctx.name = name;\n\tctx.pmType = 'bower';\n\tctx.fileType = fileType;\n\tctx.fileUrl = join(rootUrl, fileType);\n\tctx.depFolder = join(rootUrl, 'bower_components');\n\tctx.rootUrl = rootUrl;\n\treturn ctx;\n}\n\nfunction bowerChildCrawler (context, name) {\n\tvar childRoot = join(context.globalDepFolder, name);\n\tvar childCtx = bowerContext(context, childRoot, name);\n\treturn crawl(childCtx);\n}\n\nfunction bowerDependencies (context, data) {\n\treturn context.fileType === 'bower.json'\n\t\t? Object.keys(data.metadata.dependencies || {})\n\t\t: [];\n}\n\n\n});\n\n","modules":[{"pos":0,"count":106,"id":"rave@0.4.3/lib/crawl/bower","depList":["require","exports","module"],"factory":true,"argList":["require","exports","module","define"],"requires":[{"id":"rave@0.4.3/lib/path","pos":238,"count":18},{"id":"rave@0.4.3/lib/crawl/common","pos":281,"count":19}]}],"compileTime":"2014-11-17T20:58:47.332Z"}